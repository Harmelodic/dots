#!/bin/bash

# Runs the update/upgrade commands on package managers & tools, then outputs the current/new versions

# OS-specific
if [[ "$(uname)" =~ "Darwin" ]]; then
    echo "Upgrading macOS software"
    # Mac specific upgrades
    echo -e "\n--- BREW ---"
    brew update
    brew -v

    echo -e "\n--- BREW FORMULAE---"
    brew upgrade
    brew list

    echo -e "\n--- BREW CASK FORMULAE ---"
    brew upgrade --cask
    brew list --cask
elif [[ "$(uname -a)" =~ "MANJARO" ]]; then
    echo "Upgrading Manjaro software"
    # Manjaro specific upgrades
    echo -e "\n--- PACMAN PACKAGES: ---"
    sudo pacman -Syu
else
    echo -e "\nNo OS Specific updates to install for $(uname)"
fi

# OS-agnostic
echo "Upgrading OS-agnostic software"

echo -e "\n--- GCLOUD ---"
gcloud components update --quiet
gcloud version | head -1

echo -e "\n--- NPM GLOBAL MODULES ---"
npm up -g
npm ls -g --depth=0

echo -e "\n--- PIP ---"
pip install --upgrade pip
pip --version

echo -e "\n--- PIP PACKAGES ---"
pip list | awk '{print $1}' | tail +3 | xargs pip install --upgrade

echo -e "\n--- RUST ---"
rustup update
rustup -V
rustc -V

echo -e "\n--- SDKMAN ---"
[[ -s "$HOME/.sdkman/bin/sdkman-init.sh" ]] && source "$HOME/.sdkman/bin/sdkman-init.sh"
sdk update
sdk selfupdate
sdk version | xargs -I {} echo "{}"

echo -e "\n--- SDKMAN CANDIDATES: ---"
sdk upgrade
sdk current | xargs -I {} echo "{}"

echo -e "\n--- DOTS ---"
dots upgrade
